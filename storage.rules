rules_version = "2"; service firebase.storage { match /b/{bucket}/o { match /courses/{courseId}/lectures/{lectureId}/{allPaths=**} { allow read: if request.auth != null; allow write: if request.auth != null && exists(/databases/$(database)/documents/users/$(request.auth.uid)); } } }
